{% load static %}

<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚»ã‚¯ã‚¿ãƒ¼å¼·å¼±ãƒ¢ãƒ‹ã‚¿ãƒ¼</title>
    
    <!-- Bootstrap CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <!-- Bootstrap Icons CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    
    <!-- style.cssã®èª­ã¿è¾¼ã¿ -->
    <link rel="stylesheet" href="{% static 'target/css/style.css' %}">
    
</head>

<body class="bg-dark">
    <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <div class="app-container">
        <div class="schedule-container">
            <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ -->
            <div class="status-bar">
                <button class="status-bar-item" onclick="location.href='/'">ğŸ  ãƒ›ãƒ¼ãƒ </button>
                <button class="status-bar-item" id="refresh-btn">ğŸ”„ æ›´æ–°</button>
                <button class="status-bar-item" onclick="window.open('https://finance.yahoo.com/sectors', '_blank')">ãƒªãƒ³ã‚¯</button>
            </div>

            <!-- æ›´æ–°æ™‚é–“ -->
            <div class="update-time">
                â° æœ€çµ‚æ›´æ–°: <span id="update-time">{{ update_time }}</span> (JST)
            </div>

            <!-- USã‚µãƒãƒªãƒ¼ -->
            <div class="schedule-date">
                <h2 class="schedule-date-title">ğŸ‡ºğŸ‡¸ US å¸‚å ´ã‚µãƒãƒªãƒ¼</h2>
                <div class="schedule-table-container">
                    <div class="summary-metrics" id="us-summary-metrics">
                        <div class="metric-card positive">
                            <div class="metric-icon">ğŸ“ˆ</div>
                            <h2 id="us-positive-count">{{ us_summary.positive_count }}</h2>
                            <p>ä¸Šæ˜‡ã‚»ã‚¯ã‚¿ãƒ¼</p>
                        </div>
                        <div class="metric-card negative">
                            <div class="metric-icon">ğŸ“‰</div>
                            <h2 id="us-negative-count">{{ us_summary.negative_count }}</h2>
                            <p>ä¸‹è½ã‚»ã‚¯ã‚¿ãƒ¼</p>
                        </div>
                        <div class="metric-card neutral">
                            <div class="metric-icon">ğŸ“Š</div>
                            <h2 id="us-total-count">{{ us_summary.total_count }}</h2>
                            <p>ç·ã‚»ã‚¯ã‚¿ãƒ¼æ•°</p>
                        </div>
                        <div class="metric-card average">
                            <div class="metric-icon" id="us-avg-icon">{% if us_summary.avg_change > 0 %}ğŸ“ˆ{% else %}ğŸ“‰{% endif %}</div>
                            <h2 id="us-avg-change">{{ us_summary.avg_change|floatformat:2 }}%</h2>
                            <p>å¹³å‡å¤‰åŒ–ç‡</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- JPã‚µãƒãƒªãƒ¼ -->
            <div class="schedule-date">
                <h2 class="schedule-date-title">ğŸ‡¯ğŸ‡µ JP å¸‚å ´ã‚µãƒãƒªãƒ¼</h2>
                <div class="schedule-table-container">
                    <div class="summary-metrics" id="jp-summary-metrics">
                        <div class="metric-card positive">
                            <div class="metric-icon">ğŸ“ˆ</div>
                            <h2 id="jp-positive-count">{{ jp_summary.positive_count }}</h2>
                            <p>ä¸Šæ˜‡ã‚»ã‚¯ã‚¿ãƒ¼</p>
                        </div>
                        <div class="metric-card negative">
                            <div class="metric-icon">ğŸ“‰</div>
                            <h2 id="jp-negative-count">{{ jp_summary.negative_count }}</h2>
                            <p>ä¸‹è½ã‚»ã‚¯ã‚¿ãƒ¼</p>
                        </div>
                        <div class="metric-card neutral">
                            <div class="metric-icon">ğŸ“Š</div>
                            <h2 id="jp-total-count">{{ jp_summary.total_count }}</h2>
                            <p>ç·ã‚»ã‚¯ã‚¿ãƒ¼æ•°</p>
                        </div>
                        <div class="metric-card average">
                            <div class="metric-icon" id="jp-avg-icon">{% if jp_summary.avg_change > 0 %}ğŸ“ˆ{% else %}ğŸ“‰{% endif %}</div>
                            <h2 id="jp-avg-change">{{ jp_summary.avg_change|floatformat:2 }}%</h2>
                            <p>å¹³å‡å¤‰åŒ–ç‡</p>
                        </div>
                    </div>
                </div>
            </div>


            <!-- US ã‚»ã‚¯ã‚¿ãƒ¼ -->
            <div class="schedule-date">
                <h2 class="schedule-date-title">ğŸ‡ºğŸ‡¸ US ã‚»ã‚¯ã‚¿ãƒ¼ (GICS 11)</h2>
                <div class="schedule-table-container">
                    <table class="schedule-table">
                        <thead>
                            <tr>
                                <th></th>
                                <th>ã‚»ã‚¯ã‚¿ãƒ¼</th>
                                <th>å¤‰åŒ–ç‡</th>
                            </tr>
                        </thead>
                        <tbody id="us-sectors">
                            {% for sector in us_sectors %}
                            <tr class="{% if sector.change > 0 %}positive-row{% else %}negative-row{% endif %}">
                                <td class="sector-icon-cell">{{ sector.icon }}</td>
                                <td class="sector-name-cell">{{ sector.sector }}</td>
                                <td class="sector-change-cell {% if sector.change > 0 %}positive-text{% else %}negative-text{% endif %}">
                                    {{ sector.change_pct|floatformat:2 }}%
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- JP ã‚»ã‚¯ã‚¿ãƒ¼ -->
            <div class="schedule-date">
                <h2 class="schedule-date-title">ğŸ‡¯ğŸ‡µ JP ã‚»ã‚¯ã‚¿ãƒ¼ (TOPIX-17)</h2>
                <div class="schedule-table-container">
                    <table class="schedule-table">
                        <thead>
                            <tr>
                                <th></th>
                                <th>ã‚»ã‚¯ã‚¿ãƒ¼</th>
                                <th>å¤‰åŒ–ç‡</th>
                            </tr>
                        </thead>
                        <tbody id="jp-sectors">
                            {% for sector in jp_sectors %}
                            <tr class="{% if sector.change > 0 %}positive-row{% else %}negative-row{% endif %}">
                                <td class="sector-icon-cell">{{ sector.icon }}</td>
                                <td class="sector-name-cell">{{ sector.sector }}</td>
                                <td class="sector-change-cell {% if sector.change > 0 %}positive-text{% else %}negative-text{% endif %}">
                                    {{ sector.change_pct|floatformat:2 }}%
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

        </div>

        <!-- ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹ãƒœã‚¿ãƒ³ -->
        <button id="back-to-top" title="Go to top">
            <i class="bi bi-arrow-up"></i>
        </button>
    </div>

    <!-- Bootstrap Script -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Refresh button functionality
        document.getElementById('refresh-btn').addEventListener('click', function() {
            location.reload();
        });
        
        // Back to top button script
        const backToTopButton = document.getElementById("back-to-top");

        window.onscroll = function() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                backToTopButton.style.display = "block";
            } else {
                backToTopButton.style.display = "none";
            }
        };

        backToTopButton.addEventListener("click", () => {
            document.body.scrollTop = 0; // For Safari
            document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
        });
    </script>
</body>
</html>