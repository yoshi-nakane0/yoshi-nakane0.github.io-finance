{% load static %}
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>explanation - Fundamental Analysis</title>
    <!-- Bootstrap CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <!-- Bootstrap Icons CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <!-- Style -->
    <link rel="stylesheet" href="{% static 'common/css/layout.css' %}">
    <link rel="stylesheet" href="{% static 'explanation/css/style.css' %}">
</head>
<body class="bg-dark">
    <div class="app-container">
        <div class="schedule-container">
            <!-- Status Bar -->
            <div class="status-bar">
                <div class="status-bar-right">
                    <button class="status-bar-item" onclick="location.href='/'">üè† „Éõ„Éº„É†</button>
                </div>
            </div>

            <!-- Filter Buttons (JP / US) -->
            <div class="filter-buttons">
                <button class="filter-btn active" id="btn-jp">JP (Japan)</button>
                <button class="filter-btn" id="btn-us">US (America)</button>
            </div>

            <!-- =========================
                 JP View 
                 ========================= -->
            <div id="jp-view" class="view-section">
                <!-- Header -->
                <div class="earnings-container">
                    <div class="date-header">
                        <h3 class="date-title">üáØüáµ Êó•Áµå225ÂÖàÁâ© (Nikkei 225)</h3>
                    </div>
                    
                    <!-- Prediction -->
                    <div class="prediction-box">
                        <div class="prediction-label">Long/Short Expectation</div>
                        <div class="prediction-score">-- %</div>
                        <div style="margin-top:5px;">
                            <span class="badge-neutral">Neutral</span>
                        </div>
                        <div class="last-updated">Updated: --/--</div>
                    </div>
                </div>

                <!-- Macro Indicators -->
                <div class="earnings-container">
                    <div class="date-header">
                        <h3 class="date-title">üìä Êó•Êú¨„Éû„ÇØ„É≠ÊåáÊ®ô</h3>
                    </div>

                    <!-- Real Economy -->
                    <div class="spec-section-title">ÊôØÊ∞ó„ÉªÈúÄË¶Å (Real)</div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">Real GDP</div>
                            <div class="spec-name-jp">ÂÆüË≥™GDP</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">Industrial Production</div>
                            <div class="spec-name-jp">Èâ±Â∑•Ê•≠ÁîüÁî£</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>

                    <!-- Leading / Sentiment -->
                    <div class="spec-section-title">ÊôØÊ≥ÅÊÑü„ÉªÂÖàË°å (Leading)</div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">BOJ Tankan (Business Conditions DI)</div>
                            <div class="spec-name-jp">Êó•ÈäÄÁü≠Ë¶≥ÔºªÊ•≠Ê≥ÅDIÔºΩ</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>

                    <!-- Inflation -->
                    <div class="spec-section-title">Áâ©‰æ°„Éª„Ç§„É≥„Éï„É¨ (Inflation)</div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">CPI / Core CPI</div>
                            <div class="spec-name-jp">CPIÔºè„Ç≥„Ç¢CPI</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>

                    <!-- Financial Conditions -->
                    <div class="spec-section-title">ÈáëËûçÊù°‰ª∂ (Financial Conditions)</div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">BOJ Policy Rate / YCC</div>
                            <div class="spec-name-jp">Êó•ÈäÄÊîøÁ≠ñÈáëÂà©„ÉªÈï∑Áü≠ÈáëÂà©Êìç‰Ωú</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">JGB 10-Year Yield</div>
                            <div class="spec-name-jp">Êó•Êú¨ÂõΩÂÇµÂà©Âõû„ÇäÔºª10Âπ¥ÔºΩ</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">USD/JPY Exchange Rate</div>
                            <div class="spec-name-jp">USD/JPYÁÇ∫Êõø„É¨„Éº„Éà</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                </div>

                <!-- Factors -->
                <div class="earnings-container">
                    <div class="date-header">
                        <h3 class="date-title">üß© „ÉÜ„Éº„ÉûÂà•„Éï„Ç°„ÇØ„Çø„Éº</h3>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">1. Growth Factor</div>
                            <div class="spec-name-jp">ÊàêÈï∑„Éï„Ç°„ÇØ„Çø„Éº</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">2. Inflation/Fin Factor</div>
                            <div class="spec-name-jp">„Ç§„É≥„Éï„É¨„ÉªÈáëËûç„Éï„Ç°„ÇØ„Çø„Éº</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">3. US Linked Factor</div>
                            <div class="spec-name-jp">Á±≥ÂõΩÈÄ£Âãï„Éï„Ç°„ÇØ„Çø„Éº</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- =========================
                 US View 
                 ========================= -->
            <div id="us-view" class="view-section" style="display: none;">
                <!-- Header -->
                <div class="earnings-container">
                    <div class="date-header">
                        <h3 class="date-title">üá∫üá∏ Market Expectations</h3>
                    </div>

                    <div class="prediction-box">
                        <div class="prediction-label">Long/Short Expectation</div>
                        <div class="prediction-score">-- %</div>
                        <div style="margin-top:5px;">
                            <span class="badge-neutral">Neutral</span>
                        </div>
                        <div class="last-updated">Updated: --/--</div>
                    </div>
                </div>

                <!-- Macro Indicators -->
                <div class="earnings-container">
                    <div class="date-header">
                        <h3 class="date-title">üìä Á±≥ÂõΩ„Éû„ÇØ„É≠ÊåáÊ®ô</h3>
                    </div>
                    
                    <!-- Real Economy -->
                    <div class="spec-section-title">ÊôØÊ∞ó„ÉªÈúÄË¶Å (Real)</div>
                    <div class="spec-item" data-url="{% url 'explanation:us_macro_gdp' %}" style="cursor: pointer;">
                        <div class="spec-name-group">
                            <div class="spec-name-en">Real GDP (Quarterly)</div>
                            <div class="spec-name-jp">ÂÆüË≥™GDPÔºªÂõõÂçäÊúüÔºΩ</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item" data-url="{% url 'explanation:us_macro_sales' %}" style="cursor: pointer;">
                        <div class="spec-name-group">
                            <div class="spec-name-en">Retail Sales</div>
                            <div class="spec-name-jp">Â∞èÂ£≤Â£≤‰∏äÈ´ò</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">Industrial Production</div>
                            <div class="spec-name-jp">Èâ±Â∑•Ê•≠ÁîüÁî£</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    
                    <!-- Leading / Sentiment -->
                    <div class="spec-section-title">ÊôØÊ≥ÅÊÑü„ÉªÂÖàË°å (Leading)</div>
                    <div class="spec-item" data-url="{% url 'explanation:us_macro_ism' %}" style="cursor: pointer;">
                        <div class="spec-name-group">
                            <div class="spec-name-en">ISM Manufacturing / Services</div>
                            <div class="spec-name-jp">ISMË£ΩÈÄ†Ê•≠„ÉªÈùûË£ΩÈÄ†Ê•≠</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>

                    <!-- Inflation -->
                    <div class="spec-section-title">Áâ©‰æ°„Éª„Ç§„É≥„Éï„É¨ (Inflation)</div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">CPI / Core CPI</div>
                            <div class="spec-name-jp">CPIÔºè„Ç≥„Ç¢CPI</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">PCE / Core PCE</div>
                            <div class="spec-name-jp">PCEÔºè„Ç≥„Ç¢PCE</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item" data-url="{% url 'explanation:us_macro_ppi' %}" style="cursor: pointer;">
                        <div class="spec-name-group">
                            <div class="spec-name-en">PPI</div>
                            <div class="spec-name-jp">PPI</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    
                    <!-- Employment -->
                    <div class="spec-section-title">ÈõáÁî®„ÉªË≥ÉÈáë (Employment/Wages)</div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">Nonfarm Payrolls (NFP)</div>
                            <div class="spec-name-jp">ÈùûËæ≤Ê•≠ÈÉ®ÈñÄÈõáÁî®ËÄÖÊï∞ÔºªNFPÔºΩ</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">Unemployment Rate</div>
                            <div class="spec-name-jp">Â§±Ê•≠Áéá</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">Average Hourly Earnings</div>
                            <div class="spec-name-jp">Âπ≥ÂùáÊôÇÁµ¶</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">Initial Jobless Claims (Weekly)</div>
                            <div class="spec-name-jp">ÈÄ±Ê¨°Êñ∞Ë¶èÂ§±Ê•≠‰øùÈô∫Áî≥Ë´ã‰ª∂Êï∞</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>

                    <!-- Financial Conditions -->
                    <div class="spec-section-title">ÈáëËûçÊù°‰ª∂ (Financial Conditions)</div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">Policy Rate (FF Rate)</div>
                            <div class="spec-name-jp">ÊîøÁ≠ñÈáëÂà©ÔºªFFÈáëÂà©ÔºΩ</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">US Treasury Yields (2Y, 10Y)</div>
                            <div class="spec-name-jp">Á±≥ÂõΩÂÇµÂà©Âõû„ÇäÔºª2Âπ¥„Éª10Âπ¥ÔºΩ</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">Yield Curve (2s10s Spread)</div>
                            <div class="spec-name-jp">„Ç§„Éº„É´„Éâ„Ç´„Éº„ÉñÔºª2-10Âπ¥„Çπ„Éó„É¨„ÉÉ„ÉâÔºΩ</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">Credit Spreads (IG / HY)</div>
                            <div class="spec-name-jp">„ÇØ„É¨„Ç∏„ÉÉ„Éà„Çπ„Éó„É¨„ÉÉ„ÉâÔºªIGÔºèHYÔºΩ</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-name-group">
                            <div class="spec-name-en">US Dollar Index (DXY)</div>
                            <div class="spec-name-jp">„Éâ„É´„Ç§„É≥„Éá„ÉÉ„ÇØ„ÇπÔºªDXYÔºΩ</div>
                        </div>
                        <div class="spec-value-container">
                            <span class="spec-value">--</span>
                            <span class="last-updated">--/--</span>
                        </div>
                    </div>
                </div>


            </div>
            
        </div>
        
        <!-- Top Button -->
        <button id="back-to-top" title="Go to top"><i class="bi bi-arrow-up"></i></button>
    </div>

    <!-- Bootstrap Script -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Toggle View
        const btnJp = document.getElementById('btn-jp');
        const btnUs = document.getElementById('btn-us');
        const viewJp = document.getElementById('jp-view');
        const viewUs = document.getElementById('us-view');

        function switchView(viewName) {
            if (viewName === 'us') {
                btnUs.classList.add('active');
                btnJp.classList.remove('active');
                viewUs.style.display = 'block';
                viewJp.style.display = 'none';
            } else {
                btnJp.classList.add('active');
                btnUs.classList.remove('active');
                viewJp.style.display = 'block';
                viewUs.style.display = 'none';
            }
        }

        btnJp.addEventListener('click', () => switchView('jp'));
        btnUs.addEventListener('click', () => switchView('us'));

        // Check URL param on load
        const urlParams = new URLSearchParams(window.location.search);
        const initialView = urlParams.get('view');
        if (initialView === 'us') {
            switchView('us');
        } else {
            switchView('jp');
        }

        // Clickable items with dynamic return param
        document.querySelectorAll('[data-url]').forEach((item) => {
            item.addEventListener('click', () => {
                let targetUrl = item.getAttribute('data-url');
                if (targetUrl) {
                    // Determine current active view
                    const currentView = viewUs.style.display !== 'none' ? 'us' : 'jp';
                    // Check if targetUrl already has params
                    const separator = targetUrl.includes('?') ? '&' : '?';
                    location.href = `${targetUrl}${separator}from_view=${currentView}`;
                }
            });
        });

        // Back to top
        const backToTopButton = document.getElementById("back-to-top");
        window.onscroll = function() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                backToTopButton.style.display = "block";
            } else {
                backToTopButton.style.display = "none";
            }
        };
        backToTopButton.addEventListener("click", () => {
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
        });
    </script>
</body>
</html>
